
> ai-superman@1.0.0 dev
> ts-node src/index.ts

[32minfo[39m: OpenTelemetry SDK initialized successfully {"service":"azure-ai-foundry-agents","timestamp":"2025-07-27T04:05:41.041Z"}
(node:6960) [DEP0040] DeprecationWarning: The `punycode` module is deprecated. Please use a userland alternative instead.
(Use `node --trace-deprecation ...` to show where the warning was created)
[32minfo[39m: AI Superman server started {"environment":"development","port":"3000","service":"azure-ai-foundry-agents","timestamp":"2025-07-27T04:05:41.067Z"}
[32minfo[39m: Client connected to WebSocket {"service":"azure-ai-foundry-agents","socketId":"1_oYt2hlIbTcJtJdAAAB","timestamp":"2025-07-27T04:05:42.733Z"}
[32minfo[39m: Trace started {"operation":"http.get./ultra-modern.html","service":"azure-ai-foundry-agents","spanId":"09ef6ac3a6c92111","status":"started","timestamp":"2025-07-27T04:05:47.790Z","traceId":"4f15d52b-dc30-47f0-a699-c8f280abddec"}
[32minfo[39m: Trace ended {"duration":0,"operation":"http.get./ultra-modern.html","service":"azure-ai-foundry-agents","spanId":"09ef6ac3a6c92111","status":"completed","timestamp":"2025-07-27T04:05:47.798Z","traceId":"4f15d52b-dc30-47f0-a699-c8f280abddec"}
[32minfo[39m: Trace started {"operation":"http.get./ultra-modern.html","service":"azure-ai-foundry-agents","spanId":"78bf41092908ab73","status":"started","timestamp":"2025-07-27T04:14:25.149Z","traceId":"61382f8e-e568-4f5c-ba40-914477aa24ff"}
[32minfo[39m: Trace ended {"duration":0,"operation":"http.get./ultra-modern.html","service":"azure-ai-foundry-agents","spanId":"78bf41092908ab73","status":"completed","timestamp":"2025-07-27T04:14:25.153Z","traceId":"61382f8e-e568-4f5c-ba40-914477aa24ff"}
[32minfo[39m: Client disconnected from WebSocket {"service":"azure-ai-foundry-agents","socketId":"1_oYt2hlIbTcJtJdAAAB","timestamp":"2025-07-27T04:14:25.184Z"}
[32minfo[39m: Client connected to WebSocket {"service":"azure-ai-foundry-agents","socketId":"vPfAP3hB1g_ZNMVQAAAD","timestamp":"2025-07-27T04:14:25.751Z"}
[32minfo[39m: Trace started {"operation":"http.get./favicon.ico","service":"azure-ai-foundry-agents","spanId":"44efe607e536ec63","status":"started","timestamp":"2025-07-27T04:14:25.990Z","traceId":"9e9fb30a-aefd-444f-8cae-49d350f8f300"}
[32minfo[39m: Trace ended {"duration":0,"operation":"http.get./favicon.ico","service":"azure-ai-foundry-agents","spanId":"44efe607e536ec63","status":"completed","timestamp":"2025-07-27T04:14:25.993Z","traceId":"9e9fb30a-aefd-444f-8cae-49d350f8f300"}
[32minfo[39m: Client disconnected from WebSocket {"service":"azure-ai-foundry-agents","socketId":"vPfAP3hB1g_ZNMVQAAAD","timestamp":"2025-07-27T04:19:56.678Z"}
[32minfo[39m: Client connected to WebSocket {"service":"azure-ai-foundry-agents","socketId":"jsIO82Wm2TFgboEbAAAF","timestamp":"2025-07-27T04:19:57.189Z"}
[32minfo[39m: Trace started {"operation":"http.get./ultra-modern.html","service":"azure-ai-foundry-agents","spanId":"0073f8c2738fc0d0","status":"started","timestamp":"2025-07-27T04:22:04.872Z","traceId":"a32c4837-801c-40fc-9df1-36904f45d077"}
[32minfo[39m: Trace ended {"duration":0,"operation":"http.get./ultra-modern.html","service":"azure-ai-foundry-agents","spanId":"0073f8c2738fc0d0","status":"completed","timestamp":"2025-07-27T04:22:04.877Z","traceId":"a32c4837-801c-40fc-9df1-36904f45d077"}
[32minfo[39m: Client disconnected from WebSocket {"service":"azure-ai-foundry-agents","socketId":"jsIO82Wm2TFgboEbAAAF","timestamp":"2025-07-27T04:22:04.884Z"}
[32minfo[39m: Client connected to WebSocket {"service":"azure-ai-foundry-agents","socketId":"27SswLwy20dOJ5wSAAAH","timestamp":"2025-07-27T04:22:05.881Z"}
[32minfo[39m: Trace started {"operation":"http.get./favicon.ico","service":"azure-ai-foundry-agents","spanId":"4ac54462e9ad4424","status":"started","timestamp":"2025-07-27T04:22:06.072Z","traceId":"a897c6ce-f687-4efd-9e1c-9e84875ef8d7"}
[32minfo[39m: Trace ended {"duration":0,"operation":"http.get./favicon.ico","service":"azure-ai-foundry-agents","spanId":"4ac54462e9ad4424","status":"completed","timestamp":"2025-07-27T04:22:06.074Z","traceId":"a897c6ce-f687-4efd-9e1c-9e84875ef8d7"}
[32minfo[39m: Trace started {"operation":"http.post./api/process-diagram","service":"azure-ai-foundry-agents","spanId":"66113ae094ed83eb","status":"started","timestamp":"2025-07-27T04:22:32.049Z","traceId":"53125877-bca0-411c-9d58-84992c174901"}
[32minfo[39m: Processing diagram upload {"fileName":"demo1.drawio","fileSize":2231,"service":"azure-ai-foundry-agents","timestamp":"2025-07-27T04:22:32.057Z","traceId":"53125877-bca0-411c-9d58-84992c174901"}
[32minfo[39m: Trace started {"operation":"orchestrator.processArchitectureDiagram","service":"azure-ai-foundry-agents","spanId":"705d35753f4f8c22","status":"started","timestamp":"2025-07-27T04:22:32.060Z","traceId":"1008505e-9ba3-4537-a43d-6a7e994d0200"}
[32minfo[39m: Starting architecture diagram processing {"fileName":"demo1.drawio","fileSize":2231,"service":"azure-ai-foundry-agents","timestamp":"2025-07-27T04:22:32.061Z","traceId":"1008505e-9ba3-4537-a43d-6a7e994d0200"}
[32minfo[39m: Emitting processing update {"agent":"orchestrator","progress":0,"service":"azure-ai-foundry-agents","status":"in_progress","step":"initializing","timestamp":"2025-07-27T04:22:32.061Z","traceId":"1008505e-9ba3-4537-a43d-6a7e994d0200"}
[32minfo[39m: Emitting processing update {"agent":"analyzer","progress":0,"service":"azure-ai-foundry-agents","status":"starting","step":"extractArchitecture","timestamp":"2025-07-27T04:22:32.063Z","traceId":"1008505e-9ba3-4537-a43d-6a7e994d0200"}
[32minfo[39m: Emitting processing update {"agent":"orchestrator","progress":10,"service":"azure-ai-foundry-agents","status":"in_progress","step":"analyzing diagram","timestamp":"2025-07-27T04:22:32.063Z","traceId":"1008505e-9ba3-4537-a43d-6a7e994d0200"}
[32minfo[39m: Trace started {"operation":"analyzer.extractArchitecture","service":"azure-ai-foundry-agents","spanId":"13dc66b929e71996","status":"started","timestamp":"2025-07-27T04:22:32.063Z","traceId":"1008505e-9ba3-4537-a43d-6a7e994d0200"}
[32minfo[39m: Agent request: analyzer {"input":{"fileName":"demo1.drawio","fileSize":2231},"operation":"analyzer.extractArchitecture","service":"azure-ai-foundry-agents","timestamp":"2025-07-27T04:22:32.064Z","traceId":"1008505e-9ba3-4537-a43d-6a7e994d0200"}
[32minfo[39m: Starting diagram analysis {"fileName":"demo1.drawio","service":"azure-ai-foundry-agents","timestamp":"2025-07-27T04:22:32.066Z","traceId":"1008505e-9ba3-4537-a43d-6a7e994d0200"}
[32minfo[39m: Processing file {"format":"drawio","originalName":"demo1.drawio","service":"azure-ai-foundry-agents","size":2231,"timestamp":"2025-07-27T04:22:32.072Z"}
[32minfo[39m: File processed successfully {"dimensions":{"height":600,"width":800},"hasExtractedData":true,"originalFormat":"drawio","service":"azure-ai-foundry-agents","timestamp":"2025-07-27T04:22:32.347Z","traceId":"1008505e-9ba3-4537-a43d-6a7e994d0200"}
[32minfo[39m: Calling Azure AI Foundry Analyzer Agent {"endpoint":"https://digitalsupermanazureaifoundry.cognitiveservices.azure.com/openai/deployments/gpt-4.1/chat/completions?api-version=2025-01-01-preview","payloadSize":13811,"service":"azure-ai-foundry-agents","timestamp":"2025-07-27T04:22:32.347Z"}
[32minfo[39m: Diagram analysis completed {"dependencyCount":2,"originalFormat":"drawio","pattern":"Three-tier web application","resourceCount":3,"service":"azure-ai-foundry-agents","timestamp":"2025-07-27T04:22:34.347Z","traceId":"1008505e-9ba3-4537-a43d-6a7e994d0200"}
[32minfo[39m: Agent response: analyzer {"duration":2283,"operation":"analyzer.extractArchitecture","output":{"architecture":{"complexity":"moderate","components":["Web Application","SQL Database","Storage Account"],"pattern":"Three-tier web application","scalability":"medium"},"dependencies":[{"source":"webapp-frontend","target":"sqldb-main","type":"depends_on"},{"source":"webapp-frontend","target":"storage001","type":"references"}],"resources":[{"location":"East US","name":"webapp-frontend","properties":{"httpsOnly":true,"runtime":"node","sku":"Standard"},"tags":{"environment":"production","tier":"frontend"},"type":"Microsoft.Web/sites"},{"location":"East US","name":"sqldb-main","properties":{"collation":"SQL_Latin1_General_CP1_CI_AS","maxSizeBytes":"268435456000","tier":"Standard"},"tags":{"environment":"production","tier":"database"},"type":"Microsoft.Sql/servers/databases"},{"location":"East US","name":"storage001","properties":{"accessTier":"Hot","accountType":"Standard_LRS"},"tags":{"environment":"production","tier":"storage"},"type":"Microsoft.Storage/storageAccounts"}]},"service":"azure-ai-foundry-agents","status":"success","timestamp":"2025-07-27T04:22:34.348Z","traceId":"1008505e-9ba3-4537-a43d-6a7e994d0200"}
[32minfo[39m: Trace ended {"duration":0,"operation":"analyzer.extractArchitecture","service":"azure-ai-foundry-agents","spanId":"13dc66b929e71996","status":"completed","timestamp":"2025-07-27T04:22:34.349Z","traceId":"1008505e-9ba3-4537-a43d-6a7e994d0200"}
[32minfo[39m: Emitting processing update {"agent":"analyzer","progress":100,"service":"azure-ai-foundry-agents","status":"completed","step":"extractArchitecture","timestamp":"2025-07-27T04:22:34.349Z","traceId":"1008505e-9ba3-4537-a43d-6a7e994d0200"}
[32minfo[39m: Diagram analysis completed {"dependencyCount":2,"pattern":"Three-tier web application","resourceCount":3,"service":"azure-ai-foundry-agents","timestamp":"2025-07-27T04:22:34.349Z","traceId":"1008505e-9ba3-4537-a43d-6a7e994d0200"}
[32minfo[39m: Emitting processing update {"agent":"policyCompliance","progress":0,"service":"azure-ai-foundry-agents","status":"starting","step":"validateCompliance","timestamp":"2025-07-27T04:22:34.350Z","traceId":"1008505e-9ba3-4537-a43d-6a7e994d0200"}
[32minfo[39m: Emitting processing update {"agent":"orchestrator","progress":35,"service":"azure-ai-foundry-agents","status":"in_progress","step":"checking policy compliance","timestamp":"2025-07-27T04:22:34.351Z","traceId":"1008505e-9ba3-4537-a43d-6a7e994d0200"}
[32minfo[39m: Trace started {"operation":"policyCompliance.validateCompliance","service":"azure-ai-foundry-agents","spanId":"9dc97eaf1f7dbf00","status":"started","timestamp":"2025-07-27T04:22:34.352Z","traceId":"1008505e-9ba3-4537-a43d-6a7e994d0200"}
[32minfo[39m: Agent request: policyCompliance {"input":{"complianceProfile":"default","resources":[{"location":"East US","name":"webapp-frontend","properties":{"httpsOnly":true,"runtime":"node","sku":"Standard"},"tags":{"environment":"production","tier":"frontend"},"type":"Microsoft.Web/sites"},{"location":"East US","name":"sqldb-main","properties":{"collation":"SQL_Latin1_General_CP1_CI_AS","maxSizeBytes":"268435456000","tier":"Standard"},"tags":{"environment":"production","tier":"database"},"type":"Microsoft.Sql/servers/databases"},{"location":"East US","name":"storage001","properties":{"accessTier":"Hot","accountType":"Standard_LRS"},"tags":{"environment":"production","tier":"storage"},"type":"Microsoft.Storage/storageAccounts"}]},"operation":"policyCompliance.validateCompliance","service":"azure-ai-foundry-agents","timestamp":"2025-07-27T04:22:34.353Z","traceId":"1008505e-9ba3-4537-a43d-6a7e994d0200"}
[32minfo[39m: Starting policy compliance validation {"complianceProfile":"default","resourceCount":3,"service":"azure-ai-foundry-agents","timestamp":"2025-07-27T04:22:34.354Z","traceId":"1008505e-9ba3-4537-a43d-6a7e994d0200"}
[32minfo[39m: Calling Azure AI Foundry Policy Compliance Agent {"complianceProfile":"default","endpoint":"https://digitalsupermanazureaifoundry.cognitiveservices.azure.com/openai/deployments/gpt-4.1-2/chat/completions?api-version=2025-01-01-preview","resourceCount":3,"service":"azure-ai-foundry-agents","timestamp":"2025-07-27T04:22:34.355Z"}
[32minfo[39m: Policy compliance validation completed {"compliant":false,"criticalViolations":1,"service":"azure-ai-foundry-agents","timestamp":"2025-07-27T04:22:35.856Z","traceId":"1008505e-9ba3-4537-a43d-6a7e994d0200","violationCount":7}
[32minfo[39m: Agent response: policyCompliance {"duration":1503,"operation":"policyCompliance.validateCompliance","output":{"compliant":false,"recommendations":["Implement Azure Policy assignments for automated compliance monitoring","Use Azure Security Center for continuous compliance assessment","Enable diagnostic logging for all resources"],"violations":[{"description":"Missing required tag: owner","policy":"REQUIRED_TAGS","remediation":"Add owner tag to resource","resource":"webapp-frontend","severity":"medium"},{"description":"Missing required tag: cost-center","policy":"REQUIRED_TAGS","remediation":"Add cost-center tag to resource","resource":"webapp-frontend","severity":"medium"},{"description":"Missing required tag: owner","policy":"REQUIRED_TAGS","remediation":"Add owner tag to resource","resource":"sqldb-main","severity":"medium"},{"description":"Missing required tag: cost-center","policy":"REQUIRED_TAGS","remediation":"Add cost-center tag to resource","resource":"sqldb-main","severity":"medium"},{"description":"Storage account must have encryption at rest enabled","policy":"ENCRYPTION_AT_REST","remediation":"Enable encryption at rest for storage account","resource":"storage001","severity":"critical"},{"description":"Missing required tag: owner","policy":"REQUIRED_TAGS","remediation":"Add owner tag to resource","resource":"storage001","severity":"medium"},{"description":"Missing required tag: cost-center","policy":"REQUIRED_TAGS","remediation":"Add cost-center tag to resource","resource":"storage001","severity":"medium"}]},"service":"azure-ai-foundry-agents","status":"success","timestamp":"2025-07-27T04:22:35.856Z","traceId":"1008505e-9ba3-4537-a43d-6a7e994d0200"}
[32minfo[39m: Trace ended {"duration":0,"operation":"policyCompliance.validateCompliance","service":"azure-ai-foundry-agents","spanId":"9dc97eaf1f7dbf00","status":"completed","timestamp":"2025-07-27T04:22:35.857Z","traceId":"1008505e-9ba3-4537-a43d-6a7e994d0200"}
[32minfo[39m: Emitting processing update {"agent":"policyCompliance","progress":100,"service":"azure-ai-foundry-agents","status":"completed","step":"validateCompliance","timestamp":"2025-07-27T04:22:35.857Z","traceId":"1008505e-9ba3-4537-a43d-6a7e994d0200"}
[32minfo[39m: Policy compliance check completed {"compliant":false,"service":"azure-ai-foundry-agents","timestamp":"2025-07-27T04:22:35.858Z","traceId":"1008505e-9ba3-4537-a43d-6a7e994d0200","violationCount":7}
[32minfo[39m: Emitting processing update {"agent":"costOptimization","progress":0,"service":"azure-ai-foundry-agents","status":"starting","step":"optimizeCosts","timestamp":"2025-07-27T04:22:35.859Z","traceId":"1008505e-9ba3-4537-a43d-6a7e994d0200"}
[32minfo[39m: Emitting processing update {"agent":"orchestrator","progress":60,"service":"azure-ai-foundry-agents","status":"in_progress","step":"optimizing costs","timestamp":"2025-07-27T04:22:35.859Z","traceId":"1008505e-9ba3-4537-a43d-6a7e994d0200"}
[32minfo[39m: Trace started {"operation":"costOptimization.optimizeCosts","service":"azure-ai-foundry-agents","spanId":"7a1331f1000fdaca","status":"started","timestamp":"2025-07-27T04:22:35.860Z","traceId":"1008505e-9ba3-4537-a43d-6a7e994d0200"}
[32minfo[39m: Agent request: costOptimization {"input":{"resources":[{"location":"East US","name":"webapp-frontend","properties":{"httpsOnly":true,"runtime":"node","sku":"Standard"},"tags":{"environment":"production","tier":"frontend"},"type":"Microsoft.Web/sites"},{"location":"East US","name":"sqldb-main","properties":{"collation":"SQL_Latin1_General_CP1_CI_AS","maxSizeBytes":"268435456000","tier":"Standard"},"tags":{"environment":"production","tier":"database"},"type":"Microsoft.Sql/servers/databases"},{"location":"East US","name":"storage001","properties":{"accessTier":"Hot","accountType":"Standard_LRS"},"tags":{"environment":"production","tier":"storage"},"type":"Microsoft.Storage/storageAccounts"}],"targetRegion":"East Europe"},"operation":"costOptimization.optimizeCosts","service":"azure-ai-foundry-agents","timestamp":"2025-07-27T04:22:35.860Z","traceId":"1008505e-9ba3-4537-a43d-6a7e994d0200"}
[32minfo[39m: Starting cost optimization analysis {"resourceCount":3,"service":"azure-ai-foundry-agents","targetRegion":"East Europe","timestamp":"2025-07-27T04:22:35.861Z","traceId":"1008505e-9ba3-4537-a43d-6a7e994d0200"}
[32minfo[39m: Calling Azure AI Foundry Cost Optimization Agent {"endpoint":"https://digitalsupermanazureaifoundry.cognitiveservices.azure.com/openai/deployments/gpt-4.1-mini/chat/completions?api-version=2025-01-01-preview","resourceCount":3,"service":"azure-ai-foundry-agents","timestamp":"2025-07-27T04:22:35.861Z"}
[32minfo[39m: Cost optimization analysis completed {"estimatedMonthlyCost":328,"optimizationCount":3,"potentialSavings":102.19999999999999,"service":"azure-ai-foundry-agents","timestamp":"2025-07-27T04:22:37.663Z","traceId":"1008505e-9ba3-4537-a43d-6a7e994d0200"}
[32minfo[39m: Agent response: costOptimization {"duration":1803,"operation":"costOptimization.optimizeCosts","output":{"estimatedMonthlyCost":328,"optimizations":[{"impact":"high","potentialSavings":45,"resource":"sqldb-main","suggestion":"Consider using Azure SQL Database serverless for variable workloads"},{"impact":"low","potentialSavings":8,"resource":"storage001","suggestion":"Move infrequently accessed data to Cool tier"},{"impact":"high","potentialSavings":49.199999999999996,"resource":"All resources","suggestion":"Implement Azure Reserved Instances for 1-year commitment"}],"potentialSavings":102.19999999999999},"service":"azure-ai-foundry-agents","status":"success","timestamp":"2025-07-27T04:22:37.663Z","traceId":"1008505e-9ba3-4537-a43d-6a7e994d0200"}
[32minfo[39m: Trace ended {"duration":0,"operation":"costOptimization.optimizeCosts","service":"azure-ai-foundry-agents","spanId":"7a1331f1000fdaca","status":"completed","timestamp":"2025-07-27T04:22:37.664Z","traceId":"1008505e-9ba3-4537-a43d-6a7e994d0200"}
[32minfo[39m: Emitting processing update {"agent":"costOptimization","progress":100,"service":"azure-ai-foundry-agents","status":"completed","step":"optimizeCosts","timestamp":"2025-07-27T04:22:37.665Z","traceId":"1008505e-9ba3-4537-a43d-6a7e994d0200"}
[32minfo[39m: Cost optimization completed {"estimatedMonthlyCost":328,"optimizationCount":3,"potentialSavings":102.19999999999999,"service":"azure-ai-foundry-agents","timestamp":"2025-07-27T04:22:37.665Z","traceId":"1008505e-9ba3-4537-a43d-6a7e994d0200"}
[32minfo[39m: Emitting processing update {"agent":"generator","progress":0,"service":"azure-ai-foundry-agents","status":"starting","step":"generateFiles","timestamp":"2025-07-27T04:22:37.665Z","traceId":"1008505e-9ba3-4537-a43d-6a7e994d0200"}
[32minfo[39m: Emitting processing update {"agent":"orchestrator","progress":80,"service":"azure-ai-foundry-agents","status":"in_progress","step":"generating bicep files","timestamp":"2025-07-27T04:22:37.666Z","traceId":"1008505e-9ba3-4537-a43d-6a7e994d0200"}
[32minfo[39m: Trace started {"operation":"generator.generateFiles","service":"azure-ai-foundry-agents","spanId":"b836b7846fd27faf","status":"started","timestamp":"2025-07-27T04:22:37.666Z","traceId":"1008505e-9ba3-4537-a43d-6a7e994d0200"}
[32minfo[39m: Agent request: generator {"input":{"analysis":{"architecture":{"complexity":"moderate","components":["Web Application","SQL Database","Storage Account"],"pattern":"Three-tier web application","scalability":"medium"},"dependencies":[{"source":"webapp-frontend","target":"sqldb-main","type":"depends_on"},{"source":"webapp-frontend","target":"storage001","type":"references"}],"resources":[{"location":"East US","name":"webapp-frontend","properties":{"httpsOnly":true,"runtime":"node","sku":"Standard"},"tags":{"environment":"production","tier":"frontend"},"type":"Microsoft.Web/sites"},{"location":"East US","name":"sqldb-main","properties":{"collation":"SQL_Latin1_General_CP1_CI_AS","maxSizeBytes":"268435456000","tier":"Standard"},"tags":{"environment":"production","tier":"database"},"type":"Microsoft.Sql/servers/databases"},{"location":"East US","name":"storage001","properties":{"accessTier":"Hot","accountType":"Standard_LRS"},"tags":{"environment":"production","tier":"storage"},"type":"Microsoft.Storage/storageAccounts"}]},"complianceReport":{"compliant":false,"recommendations":["Implement Azure Policy assignments for automated compliance monitoring","Use Azure Security Center for continuous compliance assessment","Enable diagnostic logging for all resources"],"violations":[{"description":"Missing required tag: owner","policy":"REQUIRED_TAGS","remediation":"Add owner tag to resource","resource":"webapp-frontend","severity":"medium"},{"description":"Missing required tag: cost-center","policy":"REQUIRED_TAGS","remediation":"Add cost-center tag to resource","resource":"webapp-frontend","severity":"medium"},{"description":"Missing required tag: owner","policy":"REQUIRED_TAGS","remediation":"Add owner tag to resource","resource":"sqldb-main","severity":"medium"},{"description":"Missing required tag: cost-center","policy":"REQUIRED_TAGS","remediation":"Add cost-center tag to resource","resource":"sqldb-main","severity":"medium"},{"description":"Storage account must have encryption at rest enabled","policy":"ENCRYPTION_AT_REST","remediation":"Enable encryption at rest for storage account","resource":"storage001","severity":"critical"},{"description":"Missing required tag: owner","policy":"REQUIRED_TAGS","remediation":"Add owner tag to resource","resource":"storage001","severity":"medium"},{"description":"Missing required tag: cost-center","policy":"REQUIRED_TAGS","remediation":"Add cost-center tag to resource","resource":"storage001","severity":"medium"}]},"costOptimization":{"estimatedMonthlyCost":328,"optimizations":[{"impact":"high","potentialSavings":45,"resource":"sqldb-main","suggestion":"Consider using Azure SQL Database serverless for variable workloads"},{"impact":"low","potentialSavings":8,"resource":"storage001","suggestion":"Move infrequently accessed data to Cool tier"},{"impact":"high","potentialSavings":49.199999999999996,"resource":"All resources","suggestion":"Implement Azure Reserved Instances for 1-year commitment"}],"potentialSavings":102.19999999999999},"userRequirements":{"complianceProfile":"default","scalabilityRequirements":"","targetRegion":"East Europe"}},"operation":"generator.generateFiles","service":"azure-ai-foundry-agents","timestamp":"2025-07-27T04:22:37.667Z","traceId":"1008505e-9ba3-4537-a43d-6a7e994d0200"}
[32minfo[39m: Starting file generation {"resourceCount":3,"service":"azure-ai-foundry-agents","timestamp":"2025-07-27T04:22:37.668Z","traceId":"1008505e-9ba3-4537-a43d-6a7e994d0200","violationCount":7}
[32minfo[39m: Calling Azure AI Foundry Generator Agent {"endpoint":"https://digitalsupermanazureaifoundry.cognitiveservices.azure.com/openai/deployments/gpt-4.1-3/chat/completions?api-version=2025-01-01-preview","resourceCount":3,"service":"azure-ai-foundry-agents","timestamp":"2025-07-27T04:22:37.668Z"}
[32minfo[39m: File generation completed {"bicepSize":2480,"pipelineSize":2865,"service":"azure-ai-foundry-agents","timestamp":"2025-07-27T04:22:40.172Z","traceId":"1008505e-9ba3-4537-a43d-6a7e994d0200"}
[32minfo[39m: Agent response: generator {"duration":2506,"operation":"generator.generateFiles","output":{"bicepFile":"// Azure Bicep Template\n// Generated from architecture diagram analysis\n// Resources: 3\n// Architecture Pattern: Three-tier web application\n\ntargetScope = 'resourceGroup'\n\n@description('Location for all resources')\nparam location string = resourceGroup().location\n\n@description('Environment name')\nparam environmentName string = 'dev'\n\n@description('Resource name prefix')\nparam namePrefix string = 'app'\n\n// Variables\nvar resourcePrefix = '${namePrefix}-${environmentName}'\nvar tags = {\n  environment: environmentName\n  'generated-by': 'ai-superman'\n  pattern: 'Three-tier web application'\n}\n\n// Web App: webapp-frontend\nresource webappfrontendResource0 'Microsoft.Web/sites@2023-01-01' = {\n  name: '${resourcePrefix}-webapp-frontend'\n  location: location\n  tags: tags\n  properties: {\n    serverFarmId: appServicePlan.id\n    httpsOnly: true // Compliance: HTTPS enforcement\n    siteConfig: {\n      \n      minTlsVersion: '1.2'\n      ftpsState: 'Disabled'\n    }\n  }\n}\n\nresource appServicePlan 'Microsoft.Web/serverfarms@2023-01-01' = {\n  name: '${resourcePrefix}-asp'\n  location: location\n  tags: tags\n  sku: {\n    name: 'S1'\n    tier: 'Standard'\n  }\n}\n\n// SQL Database: sqldb-main\nresource sqlServer 'Microsoft.Sql/servers@2023-05-01-preview' = {\n  name: '${resourcePrefix}-sql'\n  location: location\n  tags: tags\n  properties: {\n    administratorLogin: 'sqladmin'\n    administratorLoginPassword: 'P@ssw0rd123!' // Use Key Vault in production\n    minimalTlsVersion: '1.2'\n  }\n}\n\nresource sqldbmainResource1 'Microsoft.Sql/servers/databases@2023-05-01-preview' = {\n  parent: sqlServer\n  name: 'sqldb-main'\n  location: location\n  tags: tags\n  properties: {\n    collation: 'SQL_Latin1_General_CP1_CI_AS'\n    maxSizeBytes: 268435456000\n    requestedServiceObjectiveName: 'S1'\n  }\n}\n\n// Storage Account: storage001\nresource storage001Resource2 'Microsoft.Storage/storageAccounts@2023-01-01' = {\n  name: take('${replace(resourcePrefix, '-', '')}storage001', 24)\n  location: location\n  tags: tags\n  kind: 'StorageV2'\n  sku: {\n    name: 'Standard_LRS'\n  }\n  properties: {\n    accessTier: 'Hot'\n    encryption: {\n      services: {\n        file: {\n          enabled: true\n        }\n        blob: {\n          enabled: true\n        }\n      }\n      keySource: 'Microsoft.Storage'\n    }\n    supportsHttpsTrafficOnly: true // Compliance: HTTPS enforcement\n    minimumTlsVersion: 'TLS1_2'\n  }\n}\n\n// Outputs\noutput webAppUrl string = 'https://${webappfrontendResource0.properties.defaultHostName}'\n","parametersFile":"{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentParameters.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"parameters\": {\n    \"location\": {\n      \"value\": \"East Europe\"\n    },\n    \"environmentName\": {\n      \"value\": \"dev\"\n    },\n    \"namePrefix\": {\n      \"value\": \"app\"\n    }\n  }\n}","pipelineYaml":"# Azure DevOps Pipeline\n# Generated from architecture diagram analysis\n# Architecture Pattern: Three-tier web application\n\ntrigger:\n  branches:\n    include:\n    - main\n    - develop\n\npool:\n  vmImage: 'ubuntu-latest'\n\nvariables:\n  azureServiceConnection: 'azure-service-connection'\n  resourceGroupName: 'rg-$(Build.Repository.Name)-$(Build.SourceBranchName)'\n  location: 'East US'\n  templateFile: 'main.bicep'\n  parametersFile: 'parameters.json'\n\nstages:\n- stage: Validate\n  displayName: 'Validate Bicep Template'\n  jobs:\n  - job: ValidateTemplate\n    displayName: 'Validate Template'\n    steps:\n    - task: AzureCLI@2\n      displayName: 'Validate Bicep Template'\n      inputs:\n        azureSubscription: $(azureServiceConnection)\n        scriptType: 'bash'\n        scriptLocation: 'inlineScript'\n        inlineScript: |\n          az group create --name $(resourceGroupName) --location \"$(location)\"\n          az deployment group validate \\\n            --resource-group $(resourceGroupName) \\\n            --template-file $(templateFile) \\\n            --parameters @$(parametersFile)\n\n- stage: Deploy\n  displayName: 'Deploy Infrastructure'\n  dependsOn: Validate\n  condition: and(succeeded(), eq(variables['Build.SourceBranch'], 'refs/heads/main'))\n  jobs:\n  - deployment: DeployInfrastructure\n    displayName: 'Deploy Infrastructure'\n    environment: 'production'\n    strategy:\n      runOnce:\n        deploy:\n          steps:\n          - task: AzureCLI@2\n            displayName: 'Deploy Bicep Template'\n            inputs:\n              azureSubscription: $(azureServiceConnection)\n              scriptType: 'bash'\n              scriptLocation: 'inlineScript'\n              inlineScript: |\n                az deployment group create \\\n                  --resource-group $(resourceGroupName) \\\n                  --template-file $(templateFile) \\\n                  --parameters @$(parametersFile) \\\n                  --verbose\n\n          - task: AzureCLI@2\n            displayName: 'Output Deployment Results'\n            inputs:\n              azureSubscription: $(azureServiceConnection)\n              scriptType: 'bash'\n              scriptLocation: 'inlineScript'\n              inlineScript: |\n                echo \"Deployment completed successfully\"\n                az resource list --resource-group $(resourceGroupName) --output table\n\n- stage: PostDeployment\n  displayName: 'Post-Deployment Validation'\n  dependsOn: Deploy\n  jobs:\n  - job: HealthChecks\n    displayName: 'Health Checks'\n    steps:\n    - task: AzureCLI@2\n      displayName: 'Run Health Checks'\n      inputs:\n        azureSubscription: $(azureServiceConnection)\n        scriptType: 'bash'\n        scriptLocation: 'inlineScript'\n        inlineScript: |\n          echo \"Running post-deployment health checks...\"\n          # Add your health check scripts here\n          echo \"Health checks completed\"\n","readmeFile":"# Azure Infrastructure Deployment\n\nThis package contains the generated Bicep template and Azure Pipeline configuration for deploying your Azure infrastructure.\n\n## Architecture Overview\n\n- **Pattern**: Three-tier web application\n- **Resources**: 3 resources\n- **Complexity**: moderate\n- **Scalability**: medium\n\n## Resources\n\n- **webapp-frontend** (Microsoft.Web/sites)\n- **sqldb-main** (Microsoft.Sql/servers/databases)\n- **storage001** (Microsoft.Storage/storageAccounts)\n\n## Cost Estimation\n\n- **Estimated Monthly Cost**: $328.00\n- **Potential Savings**: $102.20\n\n### Cost Optimizations\n- **sqldb-main**: Consider using Azure SQL Database serverless for variable workloads (Save $45.00/month)\n- **storage001**: Move infrequently accessed data to Cool tier (Save $8.00/month)\n- **All resources**: Implement Azure Reserved Instances for 1-year commitment (Save $49.20/month)\n\n## Compliance Report\n\n- **Overall Compliance**: ‚ùå Non-Compliant\n- **Violations**: 7\n\n\n### Policy Violations\n- **webapp-frontend** - REQUIRED_TAGS: Missing required tag: owner (medium)\n- **webapp-frontend** - REQUIRED_TAGS: Missing required tag: cost-center (medium)\n- **sqldb-main** - REQUIRED_TAGS: Missing required tag: owner (medium)\n- **sqldb-main** - REQUIRED_TAGS: Missing required tag: cost-center (medium)\n- **storage001** - ENCRYPTION_AT_REST: Storage account must have encryption at rest enabled (critical)\n- **storage001** - REQUIRED_TAGS: Missing required tag: owner (medium)\n- **storage001** - REQUIRED_TAGS: Missing required tag: cost-center (medium)\n\n\n## Deployment Instructions\n\n### Prerequisites\n\n1. Azure CLI installed and configured\n2. Azure DevOps project with service connection\n3. Appropriate permissions on target subscription\n\n### Local Deployment\n\n```bash\n# Create resource group\naz group create --name rg-myapp-dev --location \"East US\"\n\n# Deploy template\naz deployment group create \\\n  --resource-group rg-myapp-dev \\\n  --template-file main.bicep \\\n  --parameters @parameters.json\n```\n\n### Pipeline Deployment\n\n1. Upload these files to your Azure DevOps repository\n2. Create a new pipeline using `azure-pipeline.yml`\n3. Configure the required variables and service connections\n4. Run the pipeline\n\n## Files Included\n\n- `main.bicep` - Main Bicep template\n- `parameters.json` - Parameter values\n- `azure-pipeline.yml` - Azure DevOps pipeline\n- `README.md` - This documentation\n\n## Generated by AI Superman\n\nThis deployment package was automatically generated from your architecture diagram using AI Superman's superpowers for analysis and optimization.\n"},"service":"azure-ai-foundry-agents","status":"success","timestamp":"2025-07-27T04:22:40.173Z","traceId":"1008505e-9ba3-4537-a43d-6a7e994d0200"}
[32minfo[39m: Trace ended {"duration":0,"operation":"generator.generateFiles","service":"azure-ai-foundry-agents","spanId":"b836b7846fd27faf","status":"completed","timestamp":"2025-07-27T04:22:40.174Z","traceId":"1008505e-9ba3-4537-a43d-6a7e994d0200"}
[32minfo[39m: Emitting processing update {"agent":"generator","progress":100,"service":"azure-ai-foundry-agents","status":"completed","step":"generateFiles","timestamp":"2025-07-27T04:22:40.174Z","traceId":"1008505e-9ba3-4537-a43d-6a7e994d0200"}
[32minfo[39m: Emitting processing update {"agent":"generator","progress":90,"service":"azure-ai-foundry-agents","status":"in_progress","step":"packageFiles","timestamp":"2025-07-27T04:22:40.175Z","traceId":"1008505e-9ba3-4537-a43d-6a7e994d0200"}
[32minfo[39m: Trace started {"operation":"generator.packageFiles","service":"azure-ai-foundry-agents","spanId":"39dc73dce81ae97c","status":"started","timestamp":"2025-07-27T04:22:40.175Z","traceId":"1008505e-9ba3-4537-a43d-6a7e994d0200"}
[32minfo[39m: Agent request: generator {"input":{"traceId":"1008505e-9ba3-4537-a43d-6a7e994d0200"},"operation":"generator.packageFiles","service":"azure-ai-foundry-agents","timestamp":"2025-07-27T04:22:40.176Z","traceId":"1008505e-9ba3-4537-a43d-6a7e994d0200"}
[32minfo[39m: Starting file packaging {"service":"azure-ai-foundry-agents","timestamp":"2025-07-27T04:22:40.176Z","traceId":"1008505e-9ba3-4537-a43d-6a7e994d0200"}
[32minfo[39m: File packaging completed {"downloadUrl":"/download/azure-deployment-1008505e-9ba3-4537-a43d-6a7e994d0200.zip","service":"azure-ai-foundry-agents","timestamp":"2025-07-27T04:22:40.199Z","traceId":"1008505e-9ba3-4537-a43d-6a7e994d0200","zipFile":"azure-deployment-1008505e-9ba3-4537-a43d-6a7e994d0200.zip"}
[32minfo[39m: Agent response: generator {"duration":24,"operation":"generator.packageFiles","output":"/download/azure-deployment-1008505e-9ba3-4537-a43d-6a7e994d0200.zip","service":"azure-ai-foundry-agents","status":"success","timestamp":"2025-07-27T04:22:40.200Z","traceId":"1008505e-9ba3-4537-a43d-6a7e994d0200"}
[32minfo[39m: Trace ended {"duration":0,"operation":"generator.packageFiles","service":"azure-ai-foundry-agents","spanId":"39dc73dce81ae97c","status":"completed","timestamp":"2025-07-27T04:22:40.200Z","traceId":"1008505e-9ba3-4537-a43d-6a7e994d0200"}
[32minfo[39m: Emitting processing update {"agent":"orchestrator","progress":100,"service":"azure-ai-foundry-agents","status":"in_progress","step":"processing completed","timestamp":"2025-07-27T04:22:40.200Z","traceId":"1008505e-9ba3-4537-a43d-6a7e994d0200"}
[32minfo[39m: Emitting processing update {"agent":"orchestrator","progress":100,"service":"azure-ai-foundry-agents","status":"completed","step":"all-agents-completed","timestamp":"2025-07-27T04:22:40.200Z","traceId":"1008505e-9ba3-4537-a43d-6a7e994d0200"}
[32minfo[39m: Architecture diagram processing completed successfully {"downloadUrl":"/download/azure-deployment-1008505e-9ba3-4537-a43d-6a7e994d0200.zip","processingTime":8139,"service":"azure-ai-foundry-agents","timestamp":"2025-07-27T04:22:40.201Z","traceId":"1008505e-9ba3-4537-a43d-6a7e994d0200"}
[32minfo[39m: Trace ended {"duration":0,"operation":"orchestrator.processArchitectureDiagram","service":"azure-ai-foundry-agents","spanId":"705d35753f4f8c22","status":"completed","timestamp":"2025-07-27T04:22:40.201Z","traceId":"1008505e-9ba3-4537-a43d-6a7e994d0200"}
[32minfo[39m: Trace ended {"duration":0,"operation":"http.post./api/process-diagram","service":"azure-ai-foundry-agents","spanId":"66113ae094ed83eb","status":"completed","timestamp":"2025-07-27T04:22:40.204Z","traceId":"53125877-bca0-411c-9d58-84992c174901"}
[32minfo[39m: Client subscribed to trace {"service":"azure-ai-foundry-agents","socketId":"27SswLwy20dOJ5wSAAAH","timestamp":"2025-07-27T04:22:40.209Z","traceId":"1008505e-9ba3-4537-a43d-6a7e994d0200"}
[32minfo[39m: Client disconnected from WebSocket {"service":"azure-ai-foundry-agents","socketId":"27SswLwy20dOJ5wSAAAH","timestamp":"2025-07-27T04:26:36.578Z"}
[32minfo[39m: Client connected to WebSocket {"service":"azure-ai-foundry-agents","socketId":"lGTJ9dygkxp7xJrhAAAJ","timestamp":"2025-07-27T04:26:37.669Z"}
